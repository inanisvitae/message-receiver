"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _intercomClient=require("intercom-client"),_config=require("config"),_config2=_interopRequireDefault(_config),_bunyan=require("bunyan"),_bunyan2=_interopRequireDefault(_bunyan);const log=_bunyan2.default.createLogger({name:"customerUserRegister"}),client=new _intercomClient.Client(_config2.default.get("thirdPartyPlatform.intercom")),customerUserRegister=t=>{t.assertQueue("CUSTOMER:USER_REGISTER",{durable:!0}),t.consume("CUSTOMER:USER_REGISTER",t=>{const e=JSON.parse(t.content),_={name:`${e.first_name} ${e.last_name}`.trim(),email:e.email,user_id:e.customer_id,phone:e.phone,custom_attributes:{guest_id:null,is_from_guest:!1,is_oauth_wechat:null,is_oauth_qq:null,num_orders:0,total_payment:0,category_slug_string:"",project_slug_string:"",status_num_pending:0,status_num_paid:0,status_num_drawing:0,status_num_waiting_for_delivery:0,status_num_waiting_for_delivery_unpaid:0,status_num_delivered:0,status_num_waiting_for_pickup:0,status_num_waiting_for_pickup_unpaid:0,status_num_completed:0,status_num_closed:0,status_num_refund_pending:0,status_num_refunded:0,status_num_refund_failed:0,promoter_username_string:""}};client.users.create(_).catch(t=>{log.info(t)})},{noAck:!0})};exports.default=(t=>{t.assertQueue("CUSTOMER:USER_REGISTER",{durable:!0}),t.consume("CUSTOMER:USER_REGISTER",t=>{const e=JSON.parse(t.content),_={name:`${e.first_name} ${e.last_name}`.trim(),email:e.email,user_id:e.customer_id,phone:e.phone,custom_attributes:{guest_id:null,is_from_guest:!1,is_oauth_wechat:null,is_oauth_qq:null,num_orders:0,total_payment:0,category_slug_string:"",project_slug_string:"",status_num_pending:0,status_num_paid:0,status_num_drawing:0,status_num_waiting_for_delivery:0,status_num_waiting_for_delivery_unpaid:0,status_num_delivered:0,status_num_waiting_for_pickup:0,status_num_waiting_for_pickup_unpaid:0,status_num_completed:0,status_num_closed:0,status_num_refund_pending:0,status_num_refunded:0,status_num_refund_failed:0,promoter_username_string:""}};client.users.create(_).catch(t=>{log.info(t)})},{noAck:!0})});
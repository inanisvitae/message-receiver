"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,r){function t(i,u){try{var o=n[i](u),a=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(a).then(function(e){t("next",e)},function(e){t("throw",e)});e(a)}return t("next")})}}var _config=require("config"),_config2=_interopRequireDefault(_config),_bunyan=require("bunyan"),_bunyan2=_interopRequireDefault(_bunyan),_amqplib=require("amqplib"),_amqplib2=_interopRequireDefault(_amqplib),_intercom=require("./intercom"),_intercom2=_interopRequireDefault(_intercom),_mixpanel=require("./mixpanel"),_mixpanel2=_interopRequireDefault(_mixpanel);const log=_bunyan2.default.createLogger({name:"message_receiver"}),establishConn=(()=>{var e=_asyncToGenerator(function*(){try{return yield _amqplib2.default.connect(_config2.default.get("messageQueue.host"))}catch(e){return log.info("Failed to establish connection"),null}});return function(){return e.apply(this,arguments)}})(),conn=establishConn();(0,_intercom2.default)(conn),(0,_mixpanel2.default)(conn);